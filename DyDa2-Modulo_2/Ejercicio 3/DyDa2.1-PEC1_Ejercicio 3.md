# Master Ethereum, Tecnología Blockchain y Criptoeconomía
## Diseño y Desarrollo - 
## PEC1

### Ejercicio 3
#### Compilador Solidity. Obtener códigos de operación, Identificadores de funciones y Estimación del gas.
Se supone ya instalado el compilador de solidity. En caso de no tenerlo, para instalar el compilador de solidity:
```
npm install -g solc
```
Se obtiene un contrato de prueba por internet, lo mas simple que se ha encontrado:
> El fichero `.sol` se encuentra en el siguiente [fichero](./)
```
pragma solidity ^0.4.0;
contract Counter {
    int private count = 0;
    function incrementCounter() public {
        count += 1;
    }
    function decrementCounter() public {
        count -= 1;
    }
    function getCount() public constant returns (int) {
        return count;
    }
}
```
Para obtener los códigos de operación, realizamos una compilación primero a binario del código con el compilador:
```
$ solcjs --optimize --bin <archivo.sol>
```
Esto devolverá un archivo `.bin` que contendrá el byte code del contrato. Esto se puede incluir en un [decompilador](https://etherscan.io/opcode-tool) como el ofrecido por etherscan.io (opción que se puede realizar si no se tiene instalada la EVM). Para una mejor estimación realización un debug con la EVM instalada. Para ello utilizaremos el .bin generado y se publicará el resultado de la operación:
```
$ evm --debug --codefile contract_sol_Counter.bin run 
0x60806040526004361060525763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416635b34b96681146057578063a87d942c14606b578063f5c5ad8314608f575b600080fd5b348015606257600080fd5b50606960a1565b005b348015607657600080fd5b50607d60ac565b60408051918252519081900360200190f35b348015609a57600080fd5b50606960b2565b600080546001019055565b60005490565b600080546000190190555600a165627a7a723058204f97da1276b2ef51ea86c22dd97cb75b8578d106503fcd30d19cc041d035659c0029
#### TRACE ####
PUSH1           pc=00000000 gas=10000000000 cost=3

PUSH1           pc=00000002 gas=9999999997 cost=3
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000080

MSTORE          pc=00000004 gas=9999999994 cost=12
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000040
00000001  0000000000000000000000000000000000000000000000000000000000000080
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

PUSH1           pc=00000005 gas=9999999982 cost=3
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|

DUP1            pc=00000007 gas=9999999979 cost=3
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000000
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|

SSTORE          pc=00000008 gas=9999999976 cost=5000
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000000
00000001  0000000000000000000000000000000000000000000000000000000000000000
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

CALLVALUE       pc=00000009 gas=9999994976 cost=2
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

DUP1            pc=00000010 gas=9999994974 cost=3
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000000
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

ISZERO          pc=00000011 gas=9999994971 cost=3
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000000
00000001  0000000000000000000000000000000000000000000000000000000000000000
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

PUSH2           pc=00000012 gas=9999994968 cost=3
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000001
00000001  0000000000000000000000000000000000000000000000000000000000000000
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

JUMPI           pc=00000015 gas=9999994965 cost=10
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000014
00000001  0000000000000000000000000000000000000000000000000000000000000001
00000002  0000000000000000000000000000000000000000000000000000000000000000
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

JUMPDEST        pc=00000020 gas=9999994955 cost=1
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000000
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

POP             pc=00000021 gas=9999994954 cost=2
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000000
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

PUSH1           pc=00000022 gas=9999994952 cost=3
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

DUP1            pc=00000024 gas=9999994949 cost=3
Stack:
00000000  00000000000000000000000000000000000000000000000000000000000000ea
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

PUSH2           pc=00000025 gas=9999994946 cost=3
Stack:
00000000  00000000000000000000000000000000000000000000000000000000000000ea
00000001  00000000000000000000000000000000000000000000000000000000000000ea
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

PUSH1           pc=00000028 gas=9999994943 cost=3
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000023
00000001  00000000000000000000000000000000000000000000000000000000000000ea
00000002  00000000000000000000000000000000000000000000000000000000000000ea
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

CODECOPY        pc=00000030 gas=9999994940 cost=42
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000000
00000001  0000000000000000000000000000000000000000000000000000000000000023
00000002  00000000000000000000000000000000000000000000000000000000000000ea
00000003  00000000000000000000000000000000000000000000000000000000000000ea
Memory:
00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 80  |................|
00000060  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000070  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000080  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
000000a0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
000000b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
000000c0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
000000d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
000000e0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
000000f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

PUSH1           pc=00000031 gas=9999994898 cost=3
Stack:
00000000  00000000000000000000000000000000000000000000000000000000000000ea
Memory:
00000000  60 80 60 40 52 60 04 36  10 60 52 57 63 ff ff ff  |`.`@R`.6.`RWc...|
00000010  ff 7c 01 00 00 00 00 00  00 00 00 00 00 00 00 00  |.|..............|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 60  |...............`|
00000030  00 35 04 16 63 5b 34 b9  66 81 14 60 57 57 80 63  |.5..c[4.f..`WW.c|
00000040  a8 7d 94 2c 14 60 6b 57  80 63 f5 c5 ad 83 14 60  |.}.,.`kW.c.....`|
00000050  8f 57 5b 60 00 80 fd 5b  34 80 15 60 62 57 60 00  |.W[`...[4..`bW`.|
00000060  80 fd 5b 50 60 69 60 a1  56 5b 00 5b 34 80 15 60  |..[P`i`.V[.[4..`|
00000070  76 57 60 00 80 fd 5b 50  60 7d 60 ac 56 5b 60 40  |vW`...[P`}`.V[`@|
00000080  80 51 91 82 52 51 90 81  90 03 60 20 01 90 f3 5b  |.Q..RQ....` ...[|
00000090  34 80 15 60 9a 57 60 00  80 fd 5b 50 60 69 60 b2  |4..`.W`...[P`i`.|
000000a0  56 5b 60 00 80 54 60 01  01 90 55 56 5b 60 00 54  |V[`..T`...UV[`.T|
000000b0  90 56 5b 60 00 80 54 60  00 19 01 90 55 56 00 a1  |.V[`..T`....UV..|
000000c0  65 62 7a 7a 72 30 58 20  4f 97 da 12 76 b2 ef 51  |ebzzr0X O...v..Q|
000000d0  ea 86 c2 2d d9 7c b7 5b  85 78 d1 06 50 3f cd 30  |...-.|.[.x..P?.0|
000000e0  d1 9c c0 41 d0 35 65 9c  00 29 00 00 00 00 00 00  |...A.5e..)......|
000000f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

RETURN          pc=00000033 gas=9999994895 cost=0
Stack:
00000000  0000000000000000000000000000000000000000000000000000000000000000
00000001  00000000000000000000000000000000000000000000000000000000000000ea
Memory:
00000000  60 80 60 40 52 60 04 36  10 60 52 57 63 ff ff ff  |`.`@R`.6.`RWc...|
00000010  ff 7c 01 00 00 00 00 00  00 00 00 00 00 00 00 00  |.|..............|
00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 60  |...............`|
00000030  00 35 04 16 63 5b 34 b9  66 81 14 60 57 57 80 63  |.5..c[4.f..`WW.c|
00000040  a8 7d 94 2c 14 60 6b 57  80 63 f5 c5 ad 83 14 60  |.}.,.`kW.c.....`|
00000050  8f 57 5b 60 00 80 fd 5b  34 80 15 60 62 57 60 00  |.W[`...[4..`bW`.|
00000060  80 fd 5b 50 60 69 60 a1  56 5b 00 5b 34 80 15 60  |..[P`i`.V[.[4..`|
00000070  76 57 60 00 80 fd 5b 50  60 7d 60 ac 56 5b 60 40  |vW`...[P`}`.V[`@|
00000080  80 51 91 82 52 51 90 81  90 03 60 20 01 90 f3 5b  |.Q..RQ....` ...[|
00000090  34 80 15 60 9a 57 60 00  80 fd 5b 50 60 69 60 b2  |4..`.W`...[P`i`.|
000000a0  56 5b 60 00 80 54 60 01  01 90 55 56 5b 60 00 54  |V[`..T`...UV[`.T|
000000b0  90 56 5b 60 00 80 54 60  00 19 01 90 55 56 00 a1  |.V[`..T`....UV..|
000000c0  65 62 7a 7a 72 30 58 20  4f 97 da 12 76 b2 ef 51  |ebzzr0X O...v..Q|
000000d0  ea 86 c2 2d d9 7c b7 5b  85 78 d1 06 50 3f cd 30  |...-.|.[.x..P?.0|
000000e0  d1 9c c0 41 d0 35 65 9c  00 29 00 00 00 00 00 00  |...A.5e..)......|
000000f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
Storage:
0000000000000000000000000000000000000000000000000000000000000000: 0000000000000000000000000000000000000000000000000000000000000000

#### LOGS ####
```
En la ejecución se puede ver como la estimación de gas es de:
> 5105